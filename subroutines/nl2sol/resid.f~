subroutine resid ( meqn, nvar, x, nf, r, uiparm, urparm, ufparm )
!    Input, integer MEQN, the number of functions.
!
!    Input, integer NVAR, the number of variables.
!
!    Input, real X(NVAR), the current value of the variables.
!
!    Input, integer NF, the number of times the residual routine
!    has been called so far.
!
!    Output, real R(MEQN), the residual vector, that is, the
!    value of the functions for the given input value of the variables.
!
!    Input, integer UIPARM(*), a user array.
!
!    Input, real URPARM(*), a user array.
!
!    Input, external UFPARM, an external reference to a user subroutine
!    or function.
!
    use commonvar, only : nconst, include_errors
    ! contains npt, n, l, sd, sig, xn, w:
    use commonarray
    
    implicit none

    integer, intent(in) :: meqn
    integer, intent(in) :: nvar
    integer, intent(in) :: nf
    real, intent(in), dimension(nvar) :: x
    real, dimension(meqn) :: r


    external ufparm
    integer uiparm(*)
    real urparm(*)


  r(1) = x(1)**2 + x(2)**2 + x(1) * x(2)
  r(2) = sin ( x(1) )
  r(3) = cos ( x(2) )

  return
end
